<div class="space-y-6">
  <!-- Attendance Table Card -->
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 lg:p-6">
    <div class="flex items-center justify-between mb-4">
      <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Attendance Records for {{ mentorName() }}</h3>
      <button (click)="downloadExcel()" [disabled]="isDownloading() || isLoading() || attendances().length === 0"
        class="px-3 py-1.5 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200 flex items-center text-sm disabled:opacity-50 disabled:cursor-not-allowed">
        @if(isDownloading()){
        <i class="fas fa-spinner fa-spin mr-2"></i> Downloading...
        } @else {
        <i class="fas fa-file-excel mr-2"></i> Export to Excel
        }
      </button>
    </div>

    <div class="overflow-x-auto">
      <table
        class="min-w-full divide-y border border-gray-300 dark:border-gray-700 divide-gray-200 dark:divide-gray-700">
        <thead class="bg-gray-50 dark:bg-gray-700">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium">Attendance-in Time</th>
            <th class="px-6 py-3 text-left text-xs font-medium">Attendance-out Time</th>
            <th class="px-6 py-3 text-left text-xs font-medium">Location</th>
          </tr>
        </thead>
        <tbody class="bg-white dark:bg-gray-800 divide-y">
          @if (isLoading()) {
          <tr>
            <td colspan="4" class="px-6 py-8 text-center">Loading...</td>
          </tr>
          }
          @if (!isLoading() && attendances().length === 0) {
          <tr>
            <td colspan="4" class="px-6 py-8 text-center text-gray-500">No attendance records found for this mentor.</td>
          </tr>
          }
          @for (att of attendances(); track att.userId + att.attendanceInDateTime) {
          <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
            <td class="px-6 py-4 whitespace-nowrap">{{ att.attendanceInDateTime | date:'medium' }}</td>
            <td class="px-6 py-4 whitespace-nowrap">
              {{ att.attendanceOutDateTime ? (att.attendanceOutDateTime | date:'medium') : 'N/A' }}
            </td>
            <td class="px-6 py-4">
              <a href="https://www.google.com/maps?q={{att.latitude}},{{att.longitude}}" target="_blank"
                class="text-blue-500 hover:underline">
                View on Map <i class="fas fa-external-link-alt text-xs ml-1"></i>
              </a>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>

    <div class="mt-4">
      <app-pagination [currentPage]="currentPage()" [totalPages]="totalPages()" [totalItems]="totalItems()"
        [itemsPerPage]="itemsPerPage" [isLoading]="isLoading()" (pageChange)="onPageChange($event)">
      </app-pagination>
    </div>
  </div>
</div>